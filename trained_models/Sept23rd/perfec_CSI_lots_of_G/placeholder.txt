Per_link_Input_modification_compress_XG_alt_2

mask = tf.stop_gradient(Harden_scheduling_user_constrained(N_rf, K, M, default_val=0)(scheduled_output[:, i]))
# mask = partial_feedback_pure_greedy_model(N_rf, 32, 10, M, K, sigma2_n)(features)
# ce = tf.keras.losses.CategoricalCrossentropy()(scheduled_output[:, i], mask)
mse = tf.keras.losses.MeanSquaredError()(scheduled_output[:, i], mask)
loss_4 = loss_4 + 0.2*tf.exp(tf.constant(-scheduled_output.shape[1]+1+i, dtype=tf.float32)) * mse