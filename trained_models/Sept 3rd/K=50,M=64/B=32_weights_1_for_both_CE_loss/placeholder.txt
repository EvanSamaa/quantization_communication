weights = {2:5.0, 3:2.0, 4:1.0, 5:1.0, 6:0.2, 7:0.2, 8:0.2}

ce = All_softmaxes_CE_general(N_rf, K, M)(raw_output[:, i])
loss_4 = loss_4 + factor[N_rf] * tf.exp(tf.constant(-scheduled_output.shape[1]+1+i, dtype=tf.float32)) * ce

mask = tf.stop_gradient(Harden_scheduling(k=N_rf)(scheduled_output[:, i]))
ce = tf.keras.losses.CategoricalCrossentropy()(scheduled_output[:, i], mask)
loss_4 = loss_4 + tf.exp(tf.constant(-scheduled_output.shape[1]+1+i, dtype=tf.float32)) * ce